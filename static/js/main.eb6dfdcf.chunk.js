(this.webpackJsonpcb_pen_drawingapp=this.webpackJsonpcb_pen_drawingapp||[]).push([[0],{19:function(t,e,i){t.exports=i(32)},24:function(t,e,i){},32:function(t,e,i){"use strict";i.r(e);var a=i(0),r=i.n(a),n=i(10),s=i.n(n),o=(i(24),i(2)),l=i(3),c=i(5),h=i(4),p=i(8),d=i(1),f=i(7),u=i(6),y=function(t){Object(c.a)(i,t);var e=Object(h.a)(i);function i(t){var a;return Object(o.a)(this,i),(a=e.call(this,t)).state={pointertrace:[],changes:{},pendown:!1},a.canvRef=r.a.createRef(),a.getSize=t.getSize,a.interpretTraceEl=t.interpretTraceEl,a}return Object(l.a)(i,[{key:"pointerDownHandler",value:function(t){if(5!==t.button&&2!==t.button){var e=this.canvRef.current.parentElement.offsetTop;this.setState({pendown:!0,pointertrace:[{x:t.clientX,y:t.clientY-e}]}),this.canvRef.current.getContext("2d").beginPath()}}},{key:"pointerUpHandler",value:function(t){var e=this;if(5!==t.button&&2!==t.button){this.props.addTrace(this.state.pointertrace,this.state.changes),this.setState({pendown:!1,pointertrace:[],changes:{}}),this.canvRef.current.getContext("2d").clearRect(0,0,this.getSize().x,this.getSize().y)}else{this.setState({pendown:!1,pointertrace:[],changes:{}});for(var i=null,a=25,r=0;r<this.props.displaytraces.length;r++){var n=this.props.traces.find((function(t){return t.t===e.props.displaytraces[r].t&&"ui"===t.type}));if(n)for(var s=n.trace,o=n.t,l=0;l<s.length;l++){var c=Math.pow(Math.pow(s[l].x-t.clientX,2)+Math.pow(s[l].y-t.clientY+40,2),.5);c<a&&(i=o,a=c)}}null!==i&&this.props.delTrace(i)}}},{key:"pointerMoveHandler",value:function(t){if(5!==t.button&&2!==t.button&&this.state.pendown){var e=this.canvRef.current.parentElement.offsetTop;this.setState({pointertrace:[].concat(Object(f.a)(this.state.pointertrace),[{x:t.clientX,y:t.clientY-e}])});var i=this.canvRef.current.getContext("2d"),a=this.interpretTraceEl(this.state.pointertrace.slice(-2));a&&this.setState({changes:Object(d.a)(Object(d.a)({},this.state.changes),a)}),i.moveTo(this.state.pointertrace[this.state.pointertrace.length-1].x,this.state.pointertrace[this.state.pointertrace.length-1].y),i.strokeStyle=this.props.uicolor,i.lineTo(t.clientX,t.clientY-e),i.stroke()}}},{key:"componentDidUpdate",value:function(){this.state.pendown||this.displaytraces()}},{key:"displaytraces",value:function(){var t=this,e=this.canvRef.current.getContext("2d");e.clearRect(0,0,this.getSize().x,this.getSize().y);for(var i=0;i<this.props.displaytraces.length;i++){var a=this.props.traces.find((function(e){return e.t===t.props.displaytraces[i].t&&"ui"===e.type}));a&&this.drawtrace(e,a.trace,this.props.displaytraces[i].alpha)}}},{key:"drawtrace",value:function(t,e,i){t.strokeStyle="rgba(255, 255, 255, "+i+")",t.beginPath(),t.moveTo(e[0].x,e[0].y);for(var a=1;a<e.length;a++)t.lineTo(e[a].x,e[a].y);t.stroke()}},{key:"render",value:function(){return r.a.createElement("canvas",{id:"interactionlayer",ref:this.canvRef,height:this.getSize().y,width:this.getSize().x,onContextMenu:function(t){return t.preventDefault(),!1},onPointerDown:this.pointerDownHandler.bind(this),onPointerUp:this.pointerUpHandler.bind(this),onPointerMove:this.pointerMoveHandler.bind(this)})}}]),i}(a.Component),g=Object(u.b)((function(t,e){return{traces:t.traces,penstate:t.penstate,displaytraces:t.displaytraces}}),(function(t){return{addTrace:function(e,i){t({type:"ADD_UITRACE",trace:e,changes:i})},delTrace:function(e){t({type:"DEL_UITRACE",t:e})},clrDisplaytrace:function(){t({type:"CLR_DISPLAYTRACE"})}}}))(y),m=function(t){Object(c.a)(i,t);var e=Object(h.a)(i);function i(t){var a;return Object(o.a)(this,i),(a=e.call(this,t)).status={sliderpos:0},a.canvRef=r.a.createRef(),a}return Object(l.a)(i,[{key:"componentDidMount",value:function(){this.setState({width:this.props.width,heigth:this.props.height,sliderpos:0})}},{key:"componentDidUpdate",value:function(){this.renderCanvas()}},{key:"renderCanvas",value:function(){var t=this.canvRef.current.getContext("2d");t.clearRect(0,0,this.props.width,this.props.height),t.fillStyle=this.props.uicolor,t.strokeStyle=this.props.uicolor,"point"===this.props.title?(t.beginPath(),t.arc(11,25,10,0,2*Math.PI),t.fill()):"alpha"===this.props.title&&(t.lineWidth=2,t.beginPath(),t.arc(11,25,10,0,Math.PI),t.fill(),t.moveTo(11,10),t.arc(11,25,10,-Math.PI/4,5*Math.PI/4),t.lineTo(11,10),t.stroke()),t.lineWidth=1;var e=new Image;e.onload=function(){t.drawImage(e,0,0)},e.height=40,e.width=40,t.beginPath(),t.moveTo(50,25),t.lineTo(320,25),t.stroke(),t.beginPath(),t.lineWidth=3,t.moveTo(50+270*this.props.penstate[this.props.title],10),t.lineTo(50+270*this.props.penstate[this.props.title],40),t.stroke()}},{key:"render",value:function(){return r.a.createElement("canvas",{id:this.props.title,ref:this.canvRef,className:"slider",height:this.props.height,width:.8*this.props.width+3})}}]),i}(a.Component),v=Object(u.b)((function(t,e){return{penstate:t.penstate}}))(m),x=function(t){Object(c.a)(i,t);var e=Object(h.a)(i);function i(t){var a;return Object(o.a)(this,i),(a=e.call(this,t)).status={sliderpos:0},a.canvRef=r.a.createRef(),a}return Object(l.a)(i,[{key:"componentDidMount",value:function(){this.setState({width:this.props.width,heigth:this.props.height,sliderpos:0})}},{key:"componentDidUpdate",value:function(){this.renderCanvas()}},{key:"renderCanvas",value:function(){var t=this.canvRef.current.getContext("2d");t.clearRect(0,0,this.props.width,this.props.height),t.lineWidth=1,t.font="15px Tahoma",t.fillStyle=this.props.uicolor,this.props.title.length>5?t.fillText(this.props.title.slice(0,5)+".",0,30):t.fillText(this.props.title,0,30);var e=new Image;e.onload=function(){t.drawImage(e,0,0)},e.height=40,e.width=40,t.beginPath();var i=t.createLinearGradient(50,0,320,0),a=this.hexToHSL(this.props.penstate.color);i.addColorStop(0,this.HSLToHex(a.h,0,a.l)),i.addColorStop(1,this.HSLToHex(a.h,100,a.l)),t.fillStyle=i,t.fillRect(50,23,270,4),t.strokeRect(100,100,100,100),t.stroke(),t.strokeStyle=this.props.uicolor,t.beginPath(),t.lineWidth=3,t.moveTo(50+270*this.props.penstate[this.props.title],10),t.lineTo(50+270*this.props.penstate[this.props.title],40),t.stroke()}},{key:"hexToHSL",value:function(t){var e=0,i=0,a=0;4===t.length?(e="0x"+t[1]+t[1],i="0x"+t[2]+t[2],a="0x"+t[3]+t[3]):7===t.length&&(e="0x"+t[1]+t[2],i="0x"+t[3]+t[4],a="0x"+t[5]+t[6]),e/=255,i/=255,a/=255;var r=Math.min(e,i,a),n=Math.max(e,i,a),s=n-r,o=0,l=0;return o=0===s?0:n===e?(i-a)/s%6:n===i?(a-e)/s+2:(e-i)/s+4,(o=Math.round(60*o))<0&&(o+=360),l=(n+r)/2,{h:o,s:+(100*(0===s?0:s/(1-Math.abs(2*l-1)))).toFixed(1),l:l=+(100*l).toFixed(1)}}},{key:"HSLToHex",value:function(t,e,i){e/=100,i/=100;var a=(1-Math.abs(2*i-1))*e,r=a*(1-Math.abs(t/60%2-1)),n=i-a/2,s=0,o=0,l=0;return 0<=t&&t<60?(s=a,o=r,l=0):60<=t&&t<120?(s=r,o=a,l=0):120<=t&&t<180?(s=0,o=a,l=r):180<=t&&t<240?(s=0,o=r,l=a):240<=t&&t<300?(s=r,o=0,l=a):300<=t&&t<360&&(s=a,o=0,l=r),s=Math.round(255*(s+n)).toString(16),o=Math.round(255*(o+n)).toString(16),l=Math.round(255*(l+n)).toString(16),1===s.length&&(s="0"+s),1===o.length&&(o="0"+o),1===l.length&&(l="0"+l),"#"+s+o+l}},{key:"render",value:function(){return r.a.createElement("canvas",{id:this.props.title,ref:this.canvRef,className:"slider",height:this.props.height,width:.8*this.props.width+3})}}]),i}(a.Component),b=Object(u.b)((function(t,e){return{penstate:t.penstate,displaytraces:t.displaytraces}}))(x),w=function(t){Object(c.a)(i,t);var e=Object(h.a)(i);function i(t){var a;return Object(o.a)(this,i),(a=e.call(this,t)).state={isChecked:!1},a.canvRef=r.a.createRef(),a}return Object(l.a)(i,[{key:"componentDidUpdate",value:function(){this.renderCanvas()}},{key:"renderCanvas",value:function(){var t=this.canvRef.current.getContext("2d");t.clearRect(0,0,this.props.width,this.props.height),"linedash"===this.props.title?(t.strokeStyle=this.props.uicolor,t.lineWidth=3,t.setLineDash([3,3]),t.beginPath(),t.moveTo(40,20),t.lineTo(90,20),t.stroke()):"end"===this.props.title?(t.strokeStyle=this.props.uicolor,t.lineWidth=1,t.beginPath(),t.moveTo(40,30),t.lineTo(70,30),t.moveTo(40,10),t.lineTo(70,10),t.arc(70,20,10,3*Math.PI/2,Math.PI/2),t.moveTo(40,20),t.lineTo(70,20),t.stroke(),t.fillStyle=this.props.uicolor,t.beginPath(),t.arc(70,20,3,0,2*Math.PI),t.fill()):"line"===this.props.title?(t.strokeStyle=this.props.uicolor,t.lineWidth=1,t.beginPath(),t.moveTo(45,20),t.lineTo(85,20),t.stroke(),t.fillStyle=this.props.uicolor,t.beginPath(),t.arc(42.5,20,3,0,2*Math.PI),t.arc(87.5,20,3,0,2*Math.PI),t.fill()):"shadow"===this.props.title?(t.strokeStyle=this.props.uicolor,t.lineWidth=3,t.beginPath(),t.moveTo(40,17),t.lineTo(80,17),t.shadowColor=this.props.uicolor,t.shadowBlur=6,t.shadowOffsetX=6,t.shadowOffsetY=6,t.stroke(),t.fillStyle=this.props.uicolor,t.shadowColor="transparent"):"fill"===this.props.title?(t.beginPath(),t.fillStyle="rgb(255, 255, 255)",t.lineWidth=.224014,t.moveTo(53.171595,13.160542),t.lineTo(58.256718,18.861929),t.bezierCurveTo(58.256718,20.557044,56.561601,22.56018,56.561601,24.717437),t.bezierCurveTo(56.561601,28.261566,61.184361,28.261566,61.184361,24.563315),t.bezierCurveTo(61.184361,21.943693,59.335123,18.861929,58.410615,18.091321),t.moveTo(49.473343,11.927792),t.lineTo(55.637095,18.091544),t.lineTo(43.309592,18.091544),t.moveTo(49.858647,9.616413),t.bezierCurveTo(49.473343,9.231109,49.473343,9.231109,49.088263,9.616413),t.lineTo(39.072139,20.017842),t.bezierCurveTo(38.686834,20.403146,38.686834,20.403146,39.072139,20.788227),t.lineTo(47.547269,29.263359),t.bezierCurveTo(47.932573,29.648662,47.932573,29.648662,48.317654,29.263359),t.lineTo(58.333778,18.861929),t.lineTo(58.333778,18.091544),t.fill()):(t.lineWidth=1,t.font="15px Tahoma",t.fillStyle=this.props.uicolor,t.fillText(this.props.title,40,27)),t.setLineDash([]),t.beginPath(),t.strokeStyle=this.props.uicolor,t.lineWidth=3,t.moveTo(110,10),t.lineTo(130,10),t.lineTo(130,30),t.lineTo(110,30),t.lineTo(110,10),t.stroke(),this.props.penstate[this.props.title]&&(t.beginPath(),t.lineWidth=2,t.moveTo(110,10),t.lineTo(130,30),t.moveTo(130,10),t.lineTo(110,30),t.stroke())}},{key:"render",value:function(){return r.a.createElement("canvas",{id:this.props.title,ref:this.canvRef,height:this.props.height,width:this.props.width})}}]),i}(a.Component),T=Object(u.b)((function(t,e){return{penstate:t.penstate}}))(w),k=function(t){Object(c.a)(i,t);var e=Object(h.a)(i);function i(t){var a;return Object(o.a)(this,i),(a=e.call(this,t)).canvRef=r.a.createRef(),a}return Object(l.a)(i,[{key:"componentDidMount",value:function(){var t=this.canvRef.current.parentElement.parentElement.firstChild.getContext("2d");t.lineWidth=1,t.font="15px Tahoma",t.fillStyle=this.props.uicolor,t.fillText(this.props.title,0,15),console.log(t),this.renderCanvas()}},{key:"componentDidUpdate",value:function(){this.renderCanvas()}},{key:"renderCanvas",value:function(){var t=this.canvRef.current.getContext("2d");t.clearRect(0,0,this.props.width,this.props.height);for(var e=t.createImageData(this.props.width,this.props.height),i=this.props.penstate.saturation,a=0;a<this.props.width;a+=1)for(var r=0;r<this.props.height;r+=1){var n=r*this.props.width*4+4*a,s=a/this.props.width,o=r/this.props.height,l=this.hslToRgb(s,i,o);e.data[n+0]=l[0],e.data[n+1]=l[1],e.data[n+2]=l[2],e.data[n+3]=255}t.putImageData(e,0,0)}},{key:"hslToRgb",value:function(t,e,i){var a,r,n;if(0===e)a=r=n=i;else{var s=function(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t},o=i<.5?i*(1+e):i+e-i*e,l=2*i-o;a=s(l,o,t+1/3),r=s(l,o,t),n=s(l,o,t-1/3)}return[Math.round(255*a),Math.round(255*r),Math.round(255*n)]}},{key:"render",value:function(){return r.a.createElement("div",{id:"colorpickerwithtitle"},r.a.createElement("canvas",{id:"colorpickertitle",height:"25px",width:"300px"}),r.a.createElement("div",{id:this.props.title},r.a.createElement("canvas",{id:this.props.title+"el",ref:this.canvRef,height:this.props.height,width:this.props.width})))}}]),i}(a.Component),C=Object(u.b)((function(t,e){return{penstate:t.penstate}}),(function(t){return{setColor:function(e){t({type:"SET_COLOR"})}}}))(k),S=function(t){Object(c.a)(i,t);var e=Object(h.a)(i);function i(t){var a;return Object(o.a)(this,i),(a=e.call(this,t)).state={height:0,width:0,colorpos:{x:0,y:0}},a.divRef=r.a.createRef(),a}return Object(l.a)(i,[{key:"componentDidMount",value:function(){var t=document.getElementById("ui-container").clientHeight,e=document.getElementById("ui-container").clientWidth;this.setState({height:t,width:e});var i=this.divRef.current.firstChild.nextSibling.getContext("2d");i.fillStyle="#1C1C1C",i.fillRect(20,10,40,40),i.lineJoin="round",i.beginPath(),i.strokeStyle=this.props.uicolor,i.rect(20,10,40,40),i.stroke(),i.beginPath(),i.moveTo(25,35),i.lineTo(25,45),i.lineTo(35,45),i.lineTo(55,25),i.lineTo(45,15),i.lineTo(25,35),i.moveTo(40,20),i.lineTo(50,30),i.stroke(),i.font="20px Tahoma",i.fillStyle=this.props.uicolor,i.fillText("Settings Penstroke",70,38)}},{key:"componentDidUpdate",value:function(){}},{key:"getSize",value:function(){return{x:this.state.width,y:this.state.height}}},{key:"interpretTraceEl",value:function(t){var e,i;if(t.length<2){var a=this.divRef.current.querySelector("#checkboxdiv").childNodes;for(o=0;o<a.length;o++){if(e={x:(u=a[o]).offsetLeft+u.parentElement.offsetLeft+110,y:u.offsetTop+u.parentElement.offsetTop+10},i={x:u.offsetLeft+u.parentElement.offsetLeft+130,y:u.offsetTop+u.parentElement.offsetTop+30},this.inBox(t[0],e,i)){this.props.setCheckbox(u.id);var r=!this.props.penstate[u.id],n=u.id;return c=Object(p.a)({},n,r)}}return null}for(var s=this.divRef.current.querySelector("#sliderdiv").childNodes,o=0;o<s.length;o++){var l=s[o];if(e={x:50+l.offsetLeft,y:l.offsetTop+l.parentElement.offsetTop+25},i={x:l.offsetLeft+l.width,y:l.offsetTop+l.parentElement.offsetTop+25},this.intersects(t[0],t[1],e,i)||t[1].y==e.y&&t[1].y>e.x&&t[1].x<i.y){r=((t[0].x+t[1].x)/2-50-l.offsetLeft)/(l.width-50),n=l.id;var c={};if("saturation"===s[o].id){var h=this.hexToHSL(this.props.penstate.color),d=this.HSLToHex(h.h,100*r,h.l);return c.color=d,c[n]=r,this.props.setPenstate(c),c}return c[n]=r,this.props.setPenstate(c),c}}var f=this.divRef.current.querySelector("#checkboxdiv").childNodes;for(o=0;o<f.length;o++){var u;if(e={x:(u=f[o]).offsetLeft+u.parentElement.offsetLeft+110,y:u.offsetTop+u.parentElement.offsetTop+10},i={x:u.offsetLeft+u.parentElement.offsetLeft+130,y:u.offsetTop+u.parentElement.offsetTop+30},!this.inBox(t[0],e,i)&&this.inBox(t[1],e,i)){this.props.setCheckbox(u.id);r=!this.props.penstate[u.id],n=u.id;return c=Object(p.a)({},n,r)}var y=this.divRef.current.querySelector("#colorpickerel");if(e={x:y.offsetLeft,y:y.offsetTop},i={x:y.offsetLeft+y.width,y:y.offsetTop+y.height},this.inBox(t[1],e,i)){var g=y.getContext("2d"),m={x:t[1].x-y.offsetLeft,y:t[1].y-y.offsetTop},v=g.getImageData(m.x,m.y,1,1).data;r="#"+("000000"+this.rgbToHex(v[0],v[1],v[2])).slice(-6);return this.props.setPenstate({color:r}),{color:r}}}return null}},{key:"inBox",value:function(t,e,i){return t.x>e.x&&t.y>e.y&&t.x<i.x&&t.y<i.y}},{key:"rgbToHex",value:function(t,e,i){if(t>255||e>255||i>255)throw"Invalid color component";return(t<<16|e<<8|i).toString(16)}},{key:"hexToHSL",value:function(t){var e=0,i=0,a=0;4===t.length?(e="0x"+t[1]+t[1],i="0x"+t[2]+t[2],a="0x"+t[3]+t[3]):7===t.length&&(e="0x"+t[1]+t[2],i="0x"+t[3]+t[4],a="0x"+t[5]+t[6]),e/=255,i/=255,a/=255;var r=Math.min(e,i,a),n=Math.max(e,i,a),s=n-r,o=0,l=0;return o=0===s?0:n===e?(i-a)/s%6:n===i?(a-e)/s+2:(e-i)/s+4,(o=Math.round(60*o))<0&&(o+=360),l=(n+r)/2,{h:o,s:+(100*(0==s?0:s/(1-Math.abs(2*l-1)))).toFixed(1),l:l=+(100*l).toFixed(1)}}},{key:"HSLToHex",value:function(t,e,i){e/=100,i/=100;var a=(1-Math.abs(2*i-1))*e,r=a*(1-Math.abs(t/60%2-1)),n=i-a/2,s=0,o=0,l=0;return 0<=t&&t<60?(s=a,o=r,l=0):60<=t&&t<120?(s=r,o=a,l=0):120<=t&&t<180?(s=0,o=a,l=r):180<=t&&t<240?(s=0,o=r,l=a):240<=t&&t<300?(s=r,o=0,l=a):300<=t&&t<360&&(s=a,o=0,l=r),s=Math.round(255*(s+n)).toString(16),o=Math.round(255*(o+n)).toString(16),l=Math.round(255*(l+n)).toString(16),1===s.length&&(s="0"+s),1===o.length&&(o="0"+o),1===l.length&&(l="0"+l),"#"+s+o+l}},{key:"intersects",value:function(t,e,i,a){var r,n,s,o=t.x,l=t.y,c=e.x,h=e.y,p=i.x,d=i.y,f=a.x,u=a.y;return 0!==(r=(c-o)*(u-d)-(f-p)*(h-l))&&(n=((l-h)*(f-o)+(c-o)*(u-l))/r,0<(s=((u-d)*(f-o)+(p-f)*(u-l))/r)&&s<1&&0<n&&n<1)}},{key:"render",value:function(){return r.a.createElement("div",{id:"ui-container",ref:this.divRef},r.a.createElement(g,{getSize:this.getSize.bind(this),interpretTraceEl:this.interpretTraceEl.bind(this),uicolor:this.props.uicolor}),r.a.createElement("canvas",{id:"uititle",height:"60px",width:"400px"}),r.a.createElement("svg",{height:"3",width:"400",className:"uiline"},r.a.createElement("line",{x1:"0",y1:"2",x2:"400",y2:"2",stroke:"black"})),r.a.createElement("div",{id:"checkboxdiv"},r.a.createElement(T,{title:"linedash",className:"pencheckbox",width:.5*this.state.width,height:40,uicolor:this.props.uicolor}),r.a.createElement(T,{title:"fill",className:"pencheckbox",width:.5*this.state.width,height:40,uicolor:this.props.uicolor}),r.a.createElement(T,{title:"end",className:"pencheckbox",width:.5*this.state.width,height:40,uicolor:this.props.uicolor}),r.a.createElement(T,{title:"shadow",className:"pencheckbox",width:.5*this.state.width,height:40,uicolor:this.props.uicolor}),r.a.createElement(T,{title:"line",className:"pencheckbox",width:.5*this.state.width,height:40,uicolor:this.props.uicolor})),r.a.createElement("svg",{height:"3",width:"400",className:"uiline"},r.a.createElement("line",{x1:"0",y1:"2",x2:"400",y2:"2",stroke:"black"})),r.a.createElement("div",{id:"sliderdiv"},r.a.createElement(v,{title:"alpha",className:"penslider",width:this.state.width,height:50,uicolor:this.props.uicolor}),r.a.createElement(v,{title:"point",className:"penslider",width:this.state.width,height:50,uicolor:this.props.uicolor}),r.a.createElement(b,{title:"saturation",className:"penslider",width:this.state.width,height:50,uicolor:this.props.uicolor})),r.a.createElement("svg",{height:"3",width:"400",className:"uiline"},r.a.createElement("line",{x1:"0",y1:"2",x2:"400",y2:"2",stroke:"black"})),r.a.createElement(C,{title:"colorpicker",colorpos:this.state.colorpos,width:320,height:200,uicolor:this.props.uicolor}))}}]),i}(a.Component),E=Object(u.b)((function(t,e){return{penstate:t.penstate,uicolor:t.uicolor}}),(function(t){return{setCheckbox:function(e){t({type:"CHECK",id:e})},setPenstate:function(e){t({type:"SET_PENSTATE",update:e})}}}))(S),R=i(9),O=i.n(R),M=i(16),j=function(t){Object(c.a)(i,t);var e=Object(h.a)(i);function i(t){var a;return Object(o.a)(this,i),(a=e.call(this,t)).state={width:0},a.barRef=r.a.createRef(),a}return Object(l.a)(i,[{key:"componentDidUpdate",value:function(){var t=this.barRef.current;t.width.animVal.value-this.state.width>1&&(this.setState({width:t.width.animVal.value}),this.drawRuler())}},{key:"drawRuler",value:function(){for(var t=this.barRef.current,e=t.width.animVal.value,i=t.height.animVal.value,a=document.getElementById("drawing-canvas").width,r=(e-a+i)/2;t.firstChild;)t.removeChild(t.firstChild);for(var n=5*-Math.floor(r/5)+25;n<a+r;n+=5){var s,o,l;if(Math.abs(n)%100<1){s=document.createElementNS("http://www.w3.org/2000/svg","path"),o="M "+(n+Math.floor(r))+" 12",l="L "+(n+Math.floor(r))+" 20",s.setAttribute("d",o+" "+l),s.style.stroke="#C6C6C6",s.style.strokeWidth="1px",t.appendChild(s);var c=document.createElementNS("http://www.w3.org/2000/svg","text");c.setAttributeNS(null,"x",n+Math.floor(r)),c.setAttributeNS(null,"y",10),c.setAttributeNS(null,"text-anchor","middle"),c.setAttributeNS(null,"font-size","9"),c.style.stroke="#C6C6C6",c.innerHTML=n,t.appendChild(c)}else Math.abs(n)%20<1?(s=document.createElementNS("http://www.w3.org/2000/svg","path"),o="M "+(n+Math.floor(r))+" 16",l="L "+(n+Math.floor(r))+" 20",s.setAttribute("d",o+" "+l),s.style.stroke="#C6C6C6",s.style.strokeWidth="1px",t.appendChild(s)):(s=document.createElementNS("http://www.w3.org/2000/svg","path"),o="M "+(n+Math.floor(r))+" 18",l="L "+(n+Math.floor(r))+" 20",s.setAttribute("d",o+" "+l),s.style.stroke="#C6C6C6",s.style.strokeWidth="1px",t.appendChild(s))}}},{key:"render",value:function(){return r.a.createElement("svg",{ref:this.barRef,className:"ruler",height:"20",width:"100%"})}}]),i}(a.Component),D=function(t){Object(c.a)(i,t);var e=Object(h.a)(i);function i(t){var a;return Object(o.a)(this,i),(a=e.call(this,t)).state={height:0},a.barRef=r.a.createRef(),a}return Object(l.a)(i,[{key:"componentDidUpdate",value:function(){var t=this.barRef.current;Math.abs(t.height.animVal.value-this.state.height)>1&&(this.setState({height:t.height.animVal.value}),this.drawRuler())}},{key:"drawRuler",value:function(){for(var t=this.barRef.current,e=t.width.animVal.value,i=t.height.animVal.value,a=document.getElementById("drawing-canvas").height,r=(i-a+e)/2;t.firstChild;)t.removeChild(t.firstChild);for(var n=5*-Math.floor(r/5)+25;n<a+r;n+=5){var s,o,l;if(Math.abs(n)%100<1){s=document.createElementNS("http://www.w3.org/2000/svg","path"),o="M 12 "+(n+Math.floor(r)),l="L 20 "+(n+Math.floor(r)),s.setAttribute("d",o+" "+l),s.style.stroke="#C6C6C6",s.style.strokeWidth="1px",t.appendChild(s);var c=document.createElementNS("http://www.w3.org/2000/svg","text");c.setAttributeNS(null,"y",n+Math.floor(r)),c.setAttributeNS(null,"x",10),c.setAttributeNS(null,"text-anchor","middle"),c.setAttributeNS(null,"font-size","9"),c.style.stroke="#C6C6C6",c.setAttributeNS(null,"transform","rotate(270,10,"+(Math.floor(r)+n)+")"),c.innerHTML=n,t.appendChild(c)}else Math.abs(n)%20<1?(s=document.createElementNS("http://www.w3.org/2000/svg","path"),o="M 16 "+(n+Math.floor(r)),l="L 20 "+(n+Math.floor(r)),s.setAttribute("d",o+" "+l),s.style.stroke="#000",s.style.strokeWidth="1px",s.style.stroke="#C6C6C6",t.appendChild(s)):(s=document.createElementNS("http://www.w3.org/2000/svg","path"),o="M 18 "+(n+Math.floor(r)),l="L 20 "+(n+Math.floor(r)),s.setAttribute("d",o+" "+l),s.style.stroke="#000",s.style.strokeWidth="1px",s.style.stroke="#C6C6C6",t.appendChild(s))}}},{key:"render",value:function(){return r.a.createElement("svg",{ref:this.barRef,className:"ruler",height:"100%",width:"20px"})}}]),i}(a.Component),L=function(t){Object(c.a)(i,t);var e=Object(h.a)(i);function i(t){var a;return Object(o.a)(this,i),(a=e.call(this,t)).state={},a.canvRef=r.a.createRef(),a}return Object(l.a)(i,[{key:"getSize",value:function(){return{x:this.state.width,y:this.state.height}}},{key:"componentDidMount",value:function(){var t=document.getElementById("drawingsample-canvas").clientHeight,e=document.getElementById("drawingsample-canvas").clientWidth;console.log(t,e),this.setState({height:t,width:e})}},{key:"componentDidUpdate",value:function(){var t=this.props.penstate,e=this.canvRef.current.getContext("2d");e.clearRect(0,0,this.getSize().x,this.getSize().y),e.strokeStyle=this.getColor(t),e.lineWidth=this.getPoint(t),t.linedash?e.setLineDash([e.lineWidth,e.lineWidth]):e.setLineDash([]);var i=this.sampleTrace();if(t.end?e.lineCap="round":e.lineCap="butt",t.shadow?(e.shadowColor=this.getColor(t),e.shadowOffsetX=20,e.shadowOffsetY=20,e.shadowBlur=10):e.shadowColor="transparent",e.beginPath(),e.moveTo(i[0].x-460,i[0].y-390),t.line)e.lineTo(i[i.length-1].x-460,i[i.length-1].y-390);else for(var a=1;a<i.length;a++)e.lineTo(i[a].x-460,i[a].y-390);t.fill?(e.fillStyle=e.strokeStyle,e.fill()):e.stroke()}},{key:"getColor",value:function(t){var e=t.color.slice(0,7);return 255*t.alpha<17?e=e+"0"+Math.floor(255*t.alpha).toString(16):e+=Math.floor(255*t.alpha).toString(16),e}},{key:"getPoint",value:function(t){return 50*t.point}},{key:"sampleTrace",value:function(){return[{x:568,y:412.66668701171875},{x:567.3333740234375,y:412.66668701171875},{x:566.6666870117188,y:412.66668701171875},{x:565.3333740234375,y:412.66668701171875},{x:564.6666870117188,y:412.66668701171875},{x:563.3333740234375,y:412.66668701171875},{x:560.6666870117188,y:412.66668701171875},{x:557.3333740234375,y:413.3333740234375},{x:553.3333740234375,y:413.3333740234375},{x:548,y:414},{x:542,y:414.66668701171875},{x:535.3333740234375,y:416},{x:528,y:418},{x:520.6666870117188,y:419.3333740234375},{x:514.6666870117188,y:422},{x:508,y:424},{x:502.66668701171875,y:426.66668701171875},{x:498,y:429.3333740234375},{x:494,y:432},{x:491.3333740234375,y:434},{x:489.3333740234375,y:436.66668701171875},{x:488,y:439.3333740234375},{x:488,y:441.3333740234375},{x:488.66668701171875,y:444},{x:490,y:446},{x:492.66668701171875,y:448},{x:496.66668701171875,y:449.3333740234375},{x:501.3333740234375,y:451.3333740234375},{x:506,y:453.3333740234375},{x:511.3333740234375,y:454.66668701171875},{x:516.6666870117188,y:457.3333740234375},{x:521.3333740234375,y:459.3333740234375},{x:525.3333740234375,y:461.3333740234375},{x:528,y:463.3333740234375},{x:530.6666870117188,y:465.3333740234375},{x:532.6666870117188,y:468},{x:533.3333740234375,y:470},{x:533.3333740234375,y:472.66668701171875},{x:532.6666870117188,y:474},{x:531.3333740234375,y:476},{x:530,y:477.3333740234375},{x:528,y:479.3333740234375},{x:525.3333740234375,y:480.66668701171875},{x:522.6666870117188,y:482},{x:520.6666870117188,y:484},{x:518,y:486},{x:516,y:488},{x:514,y:490.66668701171875},{x:512,y:492.66668701171875},{x:511.3333740234375,y:495.3333740234375},{x:510.66668701171875,y:498.66668701171875},{x:510.66668701171875,y:502},{x:511.3333740234375,y:506},{x:512.6666870117188,y:510},{x:514,y:514},{x:516,y:517.3333740234375},{x:518,y:522},{x:519.3333740234375,y:525.3333740234375},{x:520.6666870117188,y:529.3333740234375},{x:520.6666870117188,y:532.6666870117188},{x:521.3333740234375,y:536},{x:520.6666870117188,y:539.3333740234375},{x:519.3333740234375,y:542},{x:518,y:545.3333740234375},{x:515.3333740234375,y:548.6666870117188},{x:513.3333740234375,y:552},{x:511.3333740234375,y:556},{x:510,y:560.6666870117188},{x:509.3333740234375,y:565.3333740234375},{x:509.3333740234375,y:570},{x:510,y:575.3333740234375}]}},{key:"render",value:function(){return r.a.createElement("canvas",{id:"drawingsample-canvas",ref:this.canvRef,height:this.getSize().y,width:this.getSize().x})}}]),i}(a.Component),I=Object(u.b)((function(t,e){return{penstate:t.penstate}}))(L),P=function(t){Object(c.a)(i,t);var e=Object(h.a)(i);function i(t){var a;return Object(o.a)(this,i),(a=e.call(this,t)).state={pointertrace:[],pendown:!1,transform:{type:"mid",x:0,y:0},moveref:null},a.canvRef=r.a.createRef(),a}return Object(l.a)(i,[{key:"componentDidMount",value:function(){var t=document.getElementById("drawing-canvas").clientHeight,e=document.getElementById("drawing-canvas").clientWidth,i=document.getElementById("drawing-canvas-container").clientHeight,a=document.getElementById("drawing-canvas-container").clientWidth;this.setState({height:t,width:e,containerheight:i,containerwidth:a});var r=this.canvRef.current.lastChild.firstChild.getContext("2d");r.fillStyle="#333333",r.fillRect(0,0,100,100),r.lineWidth=3,r.strokeStyle=this.props.uicolor,r.setLineDash([6]),r.strokeRect(0,0,100,100),r.textAlign="center",r.textBaseline="middle",r.fillStyle=this.props.uicolor,r.font="15px Tahoma";r.fillText("upload image",50,45),r.font="7px Tahoma";r.fillText("click or drag your image here",50,60)}},{key:"componentDidUpdate",value:function(){var t,e,i,a=this.canvRef.current.firstChild.firstChild.getContext("2d"),r=this.props.t+this.props.deltaT,n=!1;for(t=this.props.traces.length-1;t>0&&this.props.traces[t].t>r;--t);for(e=t;e>0;e--){if("image"===this.props.traces[e].type){n=!0;break}if("draw"===this.props.traces[e].type)break;if(this.props.traces[e].transform&&"place"===this.props.traces[e].transform.type)break}if(n&&(i=this.props.traces[e].imgData),!this.state.spiralMode&&"3"===this.props.history&&this.state.pointertrace.length>0){for(var s=this.state.pointertrace[0],o=0,l=3;l<this.state.pointertrace.length-1;l++)this.dist(this.state.pointertrace[l],s)<20&&this.dist(this.state.pointertrace[l-1],s)>this.dist(this.state.pointertrace[l],s)&&this.dist(this.state.pointertrace[l],s)<this.dist(this.state.pointertrace[l+1],s)&&o++;o>2&&this.setState({pointertrace:[],spiralMode:!0,deltaT:this.props.deltaT})}a.clearRect(0,0,this.getSize().x,this.getSize().y);var c=this.props.penstate;if(a.strokeStyle=this.getColor(c),a.lineWidth=this.getPoint(c),this.state.spiralMode&&(c={color:"#000000",alpha:1,point:.05,linedash:!1}),n){c={color:"#000000",alpha:1,point:.05,linedash:!1};for(var h,p=0,d=0,u=this.state.imgwidth,y=this.state.imgheight,g=(l=e,this.props.initpenstate);h<=l;h++)this.props.traces[h].changes&&(g=[].concat(Object(f.a)(g),[this.props.traces[h].changes]));g.color,g.shadow;for(this.props.penstate.shadow?(a.shadowColor=this.getColor(this.props.penstate),a.shadowOffsetX=20,a.shadowOffsetY=20,a.shadowBlur=10):!1===this.props.penstate.shadow&&(a.shadowColor="transparent"),l++;0<l&&l<this.props.traces.length&&!(this.props.traces[l].t>r);l++)if(this.props.traces[l].transform)switch(this.props.traces[l].transform.type){case"mid":p+=this.props.traces[l].transform.x,d+=this.props.traces[l].transform.y;break;case"tl":p+=(1-this.props.traces[l].transform.f1)*u,d+=(1-this.props.traces[l].transform.f2)*y,u*=this.props.traces[l].transform.f1,y*=this.props.traces[l].transform.f2;break;case"tr":d+=(1-this.props.traces[l].transform.f2)*y,u*=this.props.traces[l].transform.f1,y*=this.props.traces[l].transform.f2;break;case"bl":p+=(1-this.props.traces[l].transform.f1)*u,u*=this.props.traces[l].transform.f1,y*=this.props.traces[l].transform.f2;break;case"br":u*=this.props.traces[l].transform.f1,y*=this.props.traces[l].transform.f2}switch(this.state.transform.type){case"mid":p+=this.state.transform.x,d+=this.state.transform.y;break;case"tl":p+=(1-this.state.transform.f1)*u,d+=(1-this.state.transform.f2)*y,u*=this.state.transform.f1,y*=this.state.transform.f2;break;case"tr":d+=(1-this.state.transform.f2)*y,u*=this.state.transform.f1,y*=this.state.transform.f2;break;case"bl":p+=(1-this.state.transform.f1)*u,u*=this.state.transform.f1,y*=this.state.transform.f2;break;case"br":u*=this.state.transform.f1,y*=this.state.transform.f2}a.drawImage(i,p,d,u,y),this.displayHandlers(p,d,u,y),console.log(p,d)}else this.hideHandlers();if(this.state.pendown){if(this.state.spiralMode&&this.drawalltraces(),a.strokeStyle=this.getColor(c),a.lineWidth=this.getPoint(c),c.linedash?a.setLineDash([a.lineWidth,a.lineWidth]):a.setLineDash([]),c.end?a.lineCap="round":a.lineCap="butt",c.shadow?(a.shadowColor=this.getColor(c),a.shadowOffsetX=20,a.shadowOffsetY=20,a.shadowBlur=10):a.shadowColor="transparent",this.state.pointertrace.length>1){if(a.beginPath(),a.moveTo(this.state.pointertrace[0].x,this.state.pointertrace[0].y),c.line)a.lineTo(this.state.pointertrace[this.state.pointertrace.length-1].x,this.state.pointertrace[this.state.pointertrace.length-1].y);else for(l=1;l<this.state.pointertrace.length;l++)a.lineTo(this.state.pointertrace[l].x,this.state.pointertrace[l].y);c.fill?(a.fillStyle=a.strokeStyle,a.fill()):a.stroke()}}else this.drawalltraces();this.displaytraces()}},{key:"displayHandlers",value:function(t,e,i,a){var r=document.getElementById("resizehandleTL");r.style.display="block",r.style.top=e-25+"px",r.style.left=t-25+"px",(r=document.getElementById("resizehandleTR")).style.display="block",r.style.top=e-25+"px",r.style.left=i+t-25+"px",(r=document.getElementById("resizehandleBL")).style.display="block",r.style.top=e+a-25+"px",r.style.left=t-25+"px",(r=document.getElementById("resizehandleBR")).style.display="block",r.style.top=e+a-25+"px",r.style.left=t+i-25+"px",(r=document.getElementById("resizehandleMID")).style.display="block",r.style.top=e+a/2-25+"px",r.style.left=t+i/2-25+"px"}},{key:"hideHandlers",value:function(){document.getElementById("resizehandleTL").style.display="none",document.getElementById("resizehandleTR").style.display="none",document.getElementById("resizehandleBL").style.display="none",document.getElementById("resizehandleBR").style.display="none",document.getElementById("resizehandleMID").style.display="none"}},{key:"getSize",value:function(){return{x:this.state.width,y:this.state.height}}},{key:"dist",value:function(t,e){return Math.pow(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2),.5)}},{key:"diff",value:function(t,e){return{x:t.x-e.x,y:t.y-e.y}}},{key:"angle",value:function(t,e,i){var a=this.diff(t,i),r=this.diff(e,i),n=this.dist(t,i),s=this.dist(e,i);return(a.x*r.y-a.y*r.x>0?-1:1)*Math.acos((a.x*r.x+a.y*r.y)/(n*s))}},{key:"pointerDownHandler",value:function(t){var e,i,a=this.canvRef.current.firstChild.offsetTop+this.canvRef.current.parentElement.offsetTop,r=this.canvRef.current.firstChild.offsetLeft+this.canvRef.current.parentElement.offsetLeft,n={x:t.clientX-r,y:t.clientY-a},s=!1,o=this.props.t+this.props.deltaT;for(e=this.props.traces.length-1;e>0&&this.props.traces[e].t>o;--e);for(i=e;i>0;i--){if("image"===this.props.traces[i].type){s=!0;break}if("draw"===this.props.traces[i].type)break;if(this.props.traces[i].transform&&"place"===this.props.traces[i].transform.type)break}if(s){this.canvRef.current.firstChild.lastChild;var l=document.getElementById("resizehandleTL").getBoundingClientRect(),c=document.getElementById("resizehandleTR").getBoundingClientRect(),h=document.getElementById("resizehandleBL").getBoundingClientRect(),p=document.getElementById("resizehandleBR").getBoundingClientRect(),f=document.getElementById("resizehandleMID").getBoundingClientRect(),u={x:(l.left+l.right)/2,y:(l.top+l.bottom)/2,width:p.left-l.left,height:p.top-l.top};this.setState({rect:u}),this.dist(n,{x:l.left+.5*l.width-r,y:l.top+.5*l.width-a})<l.width/2?this.setState({imageplacement:"tl"}):this.dist(n,{x:c.left+.5*c.width-r,y:c.top+.5*c.width-a})<c.width/2?this.setState({imageplacement:"tr"}):this.dist(n,{x:h.left+.5*h.width-r,y:h.top+.5*h.width-a})<h.width/2?this.setState({imageplacement:"bl"}):this.dist(n,{x:p.left+.5*p.width-r,y:p.top+.5*p.width-a})<p.width/2?this.setState({imageplacement:"br"}):this.dist(n,{x:f.left+.5*f.width-r,y:f.top+.5*f.width-a})<f.width/2?this.setState({imageplacement:"mid",moveref:{x:f.left+.5*f.width-r,y:f.top+.5*f.width-a}}):l.right-r<n.x&&n.x<p.left-r&&l.bottom-a<n.y&&n.y<p.top-a&&this.setState({imageplacement:"place"})}this.setState({pendown:!0,pointertrace:[n]});var y=this.canvRef.current.firstChild.firstChild.getContext("2d");y.strokeStyle=this.getColor(this.props.initpenstate),y.lineWidth=this.getPoint(this.props.initpenstate);for(var g=this.props.initpenstate,m=0;m<this.props.traces.length;m++)"ui"===this.props.traces[m].type&&(g=Object(d.a)(Object(d.a)({},g),this.props.traces[m].changes),y.strokeStyle=this.getColor(g),y.lineWidth=this.getPoint(g))}},{key:"pointerUpHandler",value:function(t){var e=this;if(console.log(this.props.penstate.point,this.props.penstate.color),5!==t.button&&2!==t.button){if(this.state.spiralMode)this.setState({spiralMode:!1});else if(this.state.imageplacement)"init"===this.state.imageplacement||("place"===this.state.imageplacement?(this.props.addImageTrace(this.state.pointertrace,this.state.transform),this.setState({imageplacement:!1,transform:{type:"mid",x:0,y:0}})):(this.props.addImageTrace(this.state.pointertrace,this.state.transform),this.setState({imageplacement:"init",transform:{type:"mid",x:0,y:0}})));else{this.canvRef.current.firstChild.firstChild.getContext("2d").clearRect(0,0,this.getSize().x,this.getSize().y),this.props.addTrace(this.state.pointertrace)}this.setState({pendown:!1,pointertrace:[]})}else{this.setState({pendown:!1,pointertrace:[],changes:{}});for(var i=null,a=25,r=0;r<this.props.displaytraces.length;r++){var n=this.props.traces.find((function(t){return t.t===e.props.displaytraces[r].t&&"imgtrace"===t.type}));if(n)for(var s=n.trace,o=n.t,l=0;l<s.length;l++){var c=this.canvRef.current.firstChild.getBoundingClientRect().x,h=this.canvRef.current.firstChild.getBoundingClientRect().y,p=Math.pow(Math.pow(s[l].x-t.clientX+c,2)+Math.pow(s[l].y-t.clientY+h,2),.5);p<a&&(i=o,a=p)}}null!==i&&this.props.delTrace(i)}}},{key:"drawalltraces",value:function(){var t=this.canvRef.current.firstChild.firstChild.nextSibling.getContext("2d");t.clearRect(0,0,this.getSize().x,this.getSize().y);var e,i=this.props.initpenstate;t.strokeStyle=this.getColor(i),t.lineWidth=this.getPoint(i),i.linedash?t.setLineDash([t.lineWidth,t.lineWidth]):t.setLineDash([]),i.end?t.lineCap="round":t.lineCap="butt",i.shadow?(t.shadowColor=this.getColor(i),t.shadowOffsetX=20,t.shadowOffsetY=20,t.shadowBlur=10):t.shadowColor="transparent";for(var a,r,n=0,s=0,o=0;o<this.props.traces.length;o++){if(this.props.t+this.props.deltaT<this.props.traces[o].t)return;if("image"!==this.props.traces[o].type)if("imgtrace"!==this.props.traces[o].type)if("ui"!==this.props.traces[o].type){if(t.beginPath(),t.moveTo(this.props.traces[o].trace[0].x,this.props.traces[o].trace[0].y),i.line)t.lineTo(this.props.traces[o].trace[this.props.traces[o].trace.length-1].x,this.props.traces[o].trace[this.props.traces[o].trace.length-1].y);else for(c=1;c<this.props.traces[o].trace.length;c++)t.lineTo(this.props.traces[o].trace[c].x,this.props.traces[o].trace[c].y);i.fill?(t.fillStyle=t.strokeStyle,t.fill()):t.stroke()}else i=Object(d.a)(Object(d.a)({},i),this.props.traces[o].changes),t.strokeStyle=this.getColor(i),t.lineWidth=this.getPoint(i),i.linedash?t.setLineDash([t.lineWidth,t.lineWidth]):t.setLineDash([]),i.end?t.lineCap="round":t.lineCap="butt",i.shadow?(t.shadowColor=this.getColor(i),t.shadowOffsetX=20,t.shadowOffsetY=20,t.shadowBlur=10):t.shadowColor="transparent";else if("place"===this.props.traces[o].transform.type)t.drawImage(e,n,s,a,r);else switch(this.props.traces[o].transform.type){case"mid":n+=this.props.traces[o].transform.x,s+=this.props.traces[o].transform.y;break;case"tl":n+=(1-this.props.traces[o].transform.f1)*a,s+=(1-this.props.traces[o].transform.f2)*r,a*=this.props.traces[o].transform.f1,r*=this.props.traces[o].transform.f2;break;case"tr":s+=(1-this.props.traces[o].transform.f2)*r,a*=this.props.traces[o].transform.f1,r*=this.props.traces[o].transform.f2;break;case"bl":n+=(1-this.props.traces[o].transform.f1)*a,a*=this.props.traces[o].transform.f1,r*=this.props.traces[o].transform.f2;break;case"br":a*=this.props.traces[o].transform.f1,r*=this.props.traces[o].transform.f2}else{for(var l=!0,c=o;c<this.props.traces.length;c++)if(!("imgtrace"===this.props.traces[c].type||this.props.t+this.props.deltaT<this.props.traces[c].t)){l=!1;break}if(l)return;e=this.props.traces[o].imgData,a=this.props.traces[o].width,r=this.props.traces[o].height,n=0,s=0}}}},{key:"pointerMoveHandler",value:function(t){if(this.state.spiralMode&&"3"===this.props.history&&this.state.pointertrace.length>3){for(var e=this.state.pointertrace[0],i=0,a=2;a<this.state.pointertrace.length;a++){var r=this.angle(this.state.pointertrace[a-1],this.state.pointertrace[a],e);isNaN(r)||(i+=r)}this.props.setDeltaT(this.state.deltaT-Math.floor(i/Math.PI*5));var n=this.props.t+this.state.deltaT-Math.floor(i/Math.PI*5);if(n!==this.state.spiralTempT){var s=this.props.initpenstate;for(a=1;a<this.props.traces.length&&!(this.props.traces[a].t>n);a++)"ui"===this.props.traces[a].type&&(s=Object(d.a)(Object(d.a)({},s),this.props.traces[a].changes));this.props.setPenstate(s),this.setState({spiralTempT:n})}}if(this.state.pendown){var o=this.canvRef.current.firstChild.offsetTop+this.canvRef.current.parentElement.offsetTop,l=this.canvRef.current.firstChild.offsetLeft+this.canvRef.current.parentElement.offsetLeft;this.setState({pointertrace:[].concat(Object(f.a)(this.state.pointertrace),[{x:t.clientX-l,y:t.clientY-o}])});document.getElementById("resizehandleTL").getBoundingClientRect(),document.getElementById("resizehandleBR").getBoundingClientRect(),document.getElementById("resizehandleMID").getBoundingClientRect();var c,h,p=this.state.rect;switch(this.state.imageplacement){case"init":this.pointerDownHandler(t);break;case"mid":this.setState({transform:{type:"mid",x:t.clientX-l-this.state.moveref.x,y:t.clientY-o-this.state.moveref.y}});break;case"tl":c=Math.max(0,1-(t.clientX-p.x)/p.width),h=Math.max(0,1-(t.clientY-p.y)/p.height),this.setState({transform:{f1:c,f2:h,type:"tl"}});break;case"tr":c=Math.max(0,(t.clientX-p.x)/p.width),h=Math.max(0,1-(t.clientY-p.y)/p.height),this.setState({transform:{f1:c,f2:h,type:"tr"}});break;case"bl":c=Math.max(0,1-(t.clientX-p.x)/p.width),h=Math.max(0,(t.clientY-p.y)/p.height),this.setState({transform:{f1:c,f2:h,type:"bl"}});break;case"br":c=Math.max(0,(t.clientX-p.x)/p.width),h=Math.max(0,(t.clientY-p.y)/p.height),this.setState({transform:{f1:c,f2:h,type:"br"}});break;case"place":this.setState({transform:{type:"place"}})}}}},{key:"getColor",value:function(t){var e=t.color.slice(0,7);return 255*t.alpha<17?e=e+"0"+Math.floor(255*t.alpha).toString(16):e+=Math.floor(255*t.alpha).toString(16),e}},{key:"getPoint",value:function(t){return 50*t.point}},{key:"getMatrixString",value:function(t){return"matrix("+t[0]+","+t[1]+","+t[2]+","+t[3]+","+t[4]+","+t[5]+")"}},{key:"addImage",value:function(t){var e=t.target.files[0];if(this.state.imageplacement)alert("Cannot upload file during imageplacement");else if(e)if("image"===e.type.slice(0,5)){var i=new FileReader,a=document.createElement("img");a.src=t.target.files[0];var r,n,s=this;a.src=t.target.files[0],i.addEventListener("load",Object(M.a)(O.a.mark((function t(){return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a.src=i.result,!0,a.addEventListener("load",Object(M.a)(O.a.mark((function t(){return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=a.width,n=a.height,s.placeImage(a,r,n);case 3:case"end":return t.stop()}}),t)}))));case 3:case"end":return t.stop()}}),t)}))),!1),e&&i.readAsDataURL(e)}else alert("file is not an image")}},{key:"placeImage",value:function(t,e,i){this.setState({imageplacement:"init"}),this.setState({imgheight:i,imgwidth:e}),this.props.addImage(t,i,e)}},{key:"displaytraces",value:function(){for(var t=this,e=this.canvRef.current.firstChild.firstChild.getContext("2d"),i=0;i<this.props.displaytraces.length;i++){var a=this.props.traces.find((function(e){return e.t===t.props.displaytraces[i].t&&"imgtrace"===e.type}));a&&this.drawtrace(e,a.trace,this.props.displaytraces[i].alpha)}}},{key:"drawtrace",value:function(t,e,i){t.strokeStyle="rgba(0, 0, 0, "+i+")",t.lineWidth=1,t.beginPath(),t.moveTo(e[0].x,e[0].y);for(var a=1;a<e.length;a++)t.lineTo(e[a].x,e[a].y);t.stroke()}},{key:"render",value:function(){return r.a.createElement("div",{id:"canvasInteractionDiv",ref:this.canvRef,onPointerDown:this.pointerDownHandler.bind(this),onPointerUp:this.pointerUpHandler.bind(this),onPointerMove:this.pointerMoveHandler.bind(this),onContextMenu:function(t){return t.preventDefault(),!1}},r.a.createElement("div",{id:"innerCanvasContainer"},r.a.createElement("canvas",{id:"drawing-canvas",height:this.getSize().y,width:this.getSize().x}),r.a.createElement("canvas",{id:"drawing-canvas2",height:this.getSize().y,width:this.getSize().x}),r.a.createElement("div",{id:"resizehandleTL",className:"resizeHandle"}),r.a.createElement("div",{id:"resizehandleTR",className:"resizeHandle"}),r.a.createElement("div",{id:"resizehandleBL",className:"resizeHandle"}),r.a.createElement("div",{id:"resizehandleBR",className:"resizeHandle"}),r.a.createElement("div",{id:"resizehandleMID",className:"resizeHandle"})),r.a.createElement(j,null),r.a.createElement(D,null),r.a.createElement(I,null),r.a.createElement("input",{type:"file",id:"fileupload",name:"file",onChange:this.addImage.bind(this)}),r.a.createElement("label",{for:"fileupload"},r.a.createElement("canvas",{height:"100",width:"100"})))}}]),i}(a.Component),H=Object(u.b)((function(t,e){return{traces:t.traces,displaytraces:t.displaytraces,initpenstate:t.initpenstate,penstate:t.penstate,t:t.t,uicolor:t.uicolor,deltaT:t.deltaT}}),(function(t){return{addTrace:function(e){t({type:"ADD_DRAWTRACE",trace:e})},addImage:function(e,i,a){t({type:"ADD_IMAGE",imgData:e,height:i,width:a})},addImageTrace:function(e,i){t({type:"ADD_IMAGETRACE",trace:e,transform:i})},setDeltaT:function(e){t({type:"DELTA_T",deltaT:e})},setPenstate:function(e){t({type:"SET_PENSTATE",update:e})},delTrace:function(e){t({type:"DEL_UITRACE",t:e})}}}))(P),A=function(t){Object(c.a)(i,t);var e=Object(h.a)(i);function i(t){var a;return Object(o.a)(this,i),(a=e.call(this,t)).state={numOfEls:10,pentrace:[],pendown:!1,selected:[],temptrace:!1,selectedtraces:[]},a.canvRef=r.a.createRef(),a}return Object(l.a)(i,[{key:"getSize",value:function(){return{x:this.state.width,y:this.state.height}}},{key:"getUItraceList",value:function(){return this.props.traces.filter((function(t){return"ui"===t.type||"imgtrace"===t.type&&"place"!==t.transform.type})).slice(-this.state.numOfEls)}},{key:"componentDidMount",value:function(){var t=document.getElementById("historybar-canvas").clientHeight,e=document.getElementById("historybar-canvas").clientWidth;this.setState({height:t,width:e,numOfEls:Math.floor((e-20)/120)})}},{key:"drawHistory",value:function(){var t=this.getUItraceList(),e=this.canvRef.current.getContext("2d");e.canvas.width=this.getSize().x,e.canvas.height=this.getSize().y,e.clearRect(0,0,this.getSize().x,this.getSize().y),e.strokeStyle=this.props.uicolor;var i,a;for(i=0;i<t.length;i++)if(e.fillStyle=this.props.uicolor,e.textAlign="center",e.font="15px Tahoma",e.textAlign="center",i+1==t.length?e.fillText("t",70+120*i,20):e.fillText("t - "+(t.length-i-1),70+120*i,20),"ui"===t[i].type){e.font="10px Tahoma",e.textAlign="end";for(var r=Array.from(Object.keys(t[i].changes)),n=0;n<r.length;n++)e.fillText(r[n],110+120*i,180-12*n);for(e.beginPath(),e.moveTo(t[i].trace[0].x/4+25+120*i,t[i].trace[0].y/4+22),a=0;a<t[i].trace.length;a++)e.lineTo(t[i].trace[a].x/4+25+120*i,t[i].trace[a].y/4+22);e.stroke()}else if("imgtrace"===t[i].type){var s;switch(e.font="10px Tahoma",e.textAlign="end",t[i].transform.type){case"tl":s="resize: top left";break;case"tr":s="resize: top right";break;case"bl":s="resize: bottom left";break;case"br":s="resize: bottom right";break;case"mid":s="move"}for(e.fillText(s,110+120*i,180),e.beginPath(),e.moveTo(t[i].trace[0].x/6+25+120*i,30+t[i].trace[0].y/6+22),a=0;a<t[i].trace.length;a++)e.lineTo(t[i].trace[a].x/6+25+120*i,30+t[i].trace[a].y/6+22);e.stroke()}for(e.fillStyle="#3297FD22",i=0;i<t.length;i++)for(a=0;a<this.state.selectedtraces.length;a++)t[i].t===this.state.selectedtraces[a].t&&e.fillRect(20+120*i,30,100,160);e.moveTo(10,30),e.lineTo(10,this.getSize().y-10),e.lineTo(10+120*t.length,this.getSize().y-10),e.lineTo(10+120*t.length,30),e.lineTo(10,30),e.stroke()}},{key:"componentDidUpdate",value:function(){this.props.initpenstate;var t=this.canvRef.current.getContext("2d");if(this.state.pentrace.length>0){t.beginPath(),t.moveTo(this.state.pentrace[0].x,this.state.pentrace[0].y);for(var e=1;e<this.state.pentrace.length;e++)t.lineTo(this.state.pentrace[e].x,this.state.pentrace[e].y);t.stroke()}this.state.pendown||this.drawHistory()}},{key:"pointerDownHandler",value:function(t){if(5===t.button||2===t.button);else{var e=this.canvRef.current.getBoundingClientRect().x,i=this.canvRef.current.getBoundingClientRect().y;this.setState({pentrace:[{x:t.clientX-e,y:t.clientY-i}],pendown:!0})}}},{key:"pointerUpHandler",value:function(t){var e=this.getUItraceList();if((5===t.button||2===t.button)&&t.clientX%120>20&&t.clientX/120<=this.getUItraceList().length)this.props.delTrace(e[Math.floor(t.clientX/120)].t);else if(this.state.pentrace.length>1){var i=this.interpretTrace(this.state.pentrace).map((function(t){return{t:t,alpha:1}}));this.setState({selectedtraces:i,pentrace:[],pendown:!1})}}},{key:"pointerMoveHandler",value:function(t){if(!(170<t.clientX&&t.clientX<171&&702<t.clientY&&t.clientY<703)){var e=this.canvRef.current.getBoundingClientRect();if(!this.state.pendown&&t.clientY>e.top&&t.clientX%120>20&&t.clientX/120<=this.getUItraceList().length){var i=this.getUItraceList()[Math.floor(t.clientX/120)].t;this.setState({temptrace:i}),this.props.setDisplaytraces([].concat(Object(f.a)(this.state.selectedtraces),[{t:i,alpha:1}]))}if(5===t.button||2===t.button);else if(this.state.pendown){var a=this.canvRef.current.getBoundingClientRect().x,r=this.canvRef.current.getBoundingClientRect().y;this.setState({pentrace:[].concat(Object(f.a)(this.state.pentrace),[{x:t.clientX-a,y:t.clientY-r}])})}}}},{key:"pointerOutHandler",value:function(t){this.pointerUpHandler(t),this.setState({temptrace:null}),this.props.setDisplaytraces(this.state.selectedtraces)}},{key:"dist",value:function(t,e){return Math.pow(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2),.5)}},{key:"interpretTrace",value:function(t){for(var e=new Array(this.state.numOfEls).fill(0),i=0;i<t.length;i++)if(t[i].y>30&&t[i].y<this.getSize().y-10)for(var a=0;a<this.state.numOfEls;a++)if(t[i].x>20+120*a&&t[i].x<120+120*a){e[a]++;break}var r=e.map((function(t){return t>1})),n=[],s=this.getUItraceList();for(i=0;i<s.length;i++)r[i]&&n.push(s[i].t);return n}},{key:"render",value:function(){return r.a.createElement("canvas",{id:"historybar-canvas",ref:this.canvRef,height:this.getSize.bind(this).y,width:this.getSize.bind(this).x,onContextMenu:function(t){return t.preventDefault(),!1},onPointerDown:this.pointerDownHandler.bind(this),onPointerUp:this.pointerUpHandler.bind(this),onPointerMove:this.pointerMoveHandler.bind(this),onPointerOut:this.pointerOutHandler.bind(this)})}}]),i}(a.Component),B=Object(u.b)((function(t,e){return{traces:t.traces,uicolor:t.uicolor}}),(function(t){return{delTrace:function(e){t({type:"DEL_UITRACE",t:e})},setPenstate:function(e){t({type:"SET_PENSTATE",update:e})},setInit:function(){t({type:"SET_INIT"})},addDisplaytrace:function(e,i){t({type:"ADD_DISPLAYTRACE",t:e,alpha:i})},setDisplaytraces:function(e){t({type:"SET_DISPLAYTRACES",list:e})},clrDisplaytraces:function(){t({type:"CLR_DISPLAYTRACES"})},clrDisplaytrace:function(e){t({type:"CLR_DISPLAYTRACE",t:e})}}}))(A),z=function(t){Object(c.a)(i,t);var e=Object(h.a)(i);function i(t){var a;return Object(o.a)(this,i),(a=e.call(this,t)).state={selectedOption:"0",pointertrace:[]},a.setHistory=t.setHistory,a.canvRef=r.a.createRef(),a}return Object(l.a)(i,[{key:"componentDidMount",value:function(){this.drawComponent()}},{key:"componentDidUpdate",value:function(){this.drawComponent();var t=this.canvRef.current.getContext("2d");if(this.state.pointertrace.length>0){t.beginPath(),t.strokeStyle=this.props.uicolor,t.moveTo(this.state.pointertrace[0].x,this.state.pointertrace[0].y);for(var e=1;e<this.state.pointertrace.length;e++)t.lineTo(this.state.pointertrace[e].x,this.state.pointertrace[e].y)}t.stroke()}},{key:"drawComponent",value:function(){var t=this.canvRef.current.getContext("2d");t.clearRect(0,0,350,40);for(var e=0;e<4;e++)t.strokeStyle=this.props.uicolor,t.beginPath(),t.arc(15+70*e+70,20,10,0,2*Math.PI),t.rect(32+70*e+70,5,30,30),t.stroke();for(t.beginPath(),t.moveTo(102,5),t.lineTo(132,35),t.stroke(),t.beginPath(),t.rect(172,25,30,10),t.fillStyle=this.props.uicolor,t.fill(),t.beginPath(),t.moveTo(247,10),t.lineTo(267,10),t.lineTo(267,30),t.lineTo(247,30),t.lineTo(247,10),t.moveTo(247,10),t.lineTo(267,30),t.moveTo(267,10),t.lineTo(247,30),t.stroke(),t.beginPath(),e=0;e<130;e++){var i=.1*e,a=327+(1+i)*Math.cos(i),r=20+(1+i)*Math.sin(i);t.lineTo(a,r)}t.stroke(),t.beginPath(),t.arc(85+70*this.state.selectedOption,20,6,0,2*Math.PI),t.fill()}},{key:"pointerDownHandler",value:function(t){var e={x:t.clientX-this.canvRef.current.getBoundingClientRect().x,y:t.clientY-this.canvRef.current.getBoundingClientRect().y};this.setState({pointertrace:[e],pendown:!0});for(var i=0;i<4;i++)if(this.dist(e,{x:10+70*i+70,y:20})<10){this.setState({selectedOption:i}),this.props.clrDisplaytraces(),this.setHistory(i.toString());break}}},{key:"pointerUpHandler",value:function(t){this.setState({pointertrace:[],pendown:!1})}},{key:"pointerMoveHandler",value:function(t){if(this.state.pendown){var e={x:t.clientX-this.canvRef.current.getBoundingClientRect().x,y:t.clientY-this.canvRef.current.getBoundingClientRect().y};this.setState({pointertrace:[].concat(Object(f.a)(this.state.pointertrace),[e])});for(var i=0;i<4;i++)if(this.dist(e,{x:10+70*i+70,y:20})<10){this.setState({selectedOption:i}),this.props.clrDisplaytraces(),this.setHistory(i.toString());break}}}},{key:"dist",value:function(t,e){return Math.pow(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2),.5)}},{key:"handleOptionChange",value:function(t){this.setState({selectedOption:t.target.value}),this.setHistory(t.target.value)}},{key:"render",value:function(){return r.a.createElement("canvas",{ref:this.canvRef,id:"historyselector",height:"40px",width:"350px",onPointerDown:this.pointerDownHandler.bind(this),onPointerUp:this.pointerUpHandler.bind(this),onPointerMove:this.pointerMoveHandler.bind(this)})}}]),i}(a.Component),N=Object(u.b)((function(t,e){return{uicolor:t.uicolor}}),(function(t){return{clrDisplaytraces:function(){t({type:"CLR_DISPLAYTRACES"})}}}))(z),U=i(11),W=function(t){Object(c.a)(i,t);var e=Object(h.a)(i);function i(t){var a;return Object(o.a)(this,i),(a=e.call(this,t)).state={numOfEls:5,pointertrace:[]},a.canvRef=r.a.createRef(),a.handleInputChange=a.handleInputChange.bind(Object(U.a)(a)),a}return Object(l.a)(i,[{key:"handleInputChange",value:function(t){var e=t.target,i="historybox"===e.name?e.checked:e.value,a=e.name;this.setState(Object(p.a)({},a,i))}},{key:"componentDidUpdate",value:function(){var t=this.canvRef.current.getContext("2d");if(t.clearRect(0,0,100,100),this.drawComponent(),this.state.pointertrace.length>0){t.beginPath(),t.moveTo(this.state.pointertrace[0].x,this.state.pointertrace[0].y);for(var e=1;e<this.state.pointertrace.length;e++)t.lineTo(this.state.pointertrace[e].x,this.state.pointertrace[e].y)}if(t.stroke(),this.props.clrDisplaytraces(),this.state.historybox){var i=this.getUItraceList();for(e=0;e<i.length;e++)this.props.addDisplaytrace(i[e].t,1)}}},{key:"componentDidMount",value:function(){this.drawComponent()}},{key:"drawComponent",value:function(){var t=this.canvRef.current.getContext("2d");t.strokeStyle=this.props.uicolor,t.beginPath(),t.rect(50,50,40,40),this.state.historybox&&(t.moveTo(50,50),t.lineTo(90,90),t.moveTo(90,50),t.lineTo(50,90)),t.stroke(),t.fillStyle=this.props.uicolor,t.font="12px Tahoma",t.textAlign="end",t.fillText("Display",40,67),t.fillText("Traces",40,85)}},{key:"getUItraceList",value:function(){return this.props.traces.filter((function(t){return"ui"===t.type||"imgtrace"===t.type&&"place"!==t.transform.type}))}},{key:"pointerDownHandler",value:function(t){var e={x:t.clientX-this.canvRef.current.getBoundingClientRect().x,y:t.clientY-this.canvRef.current.getBoundingClientRect().y};this.setState({pointertrace:[e],pendown:!0})}},{key:"pointerUpHandler",value:function(t){var e={x:t.clientX-this.canvRef.current.getBoundingClientRect().x,y:t.clientY-this.canvRef.current.getBoundingClientRect().y};if(this.state.pointertrace.length<4&&this.inBox(e,{x:50,y:50},{x:90,y:90})){var i=!this.state.historybox;this.setState({historybox:i})}this.setState({pointertrace:[],pendown:!1})}},{key:"pointerMoveHandler",value:function(t){if(this.state.pendown){var e={x:t.clientX-this.canvRef.current.getBoundingClientRect().x,y:t.clientY-this.canvRef.current.getBoundingClientRect().y},i={x:50,y:50},a={x:90,y:90};if(this.state.pointertrace.length>0&&!this.inBox(this.state.pointertrace[this.state.pointertrace.length-1],i,a)&&this.inBox(e,i,a)){var r=!this.state.historybox;this.setState({historybox:r})}this.setState({pointertrace:[].concat(Object(f.a)(this.state.pointertrace),[e])})}}},{key:"dist",value:function(t,e){return Math.pow(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2),.5)}},{key:"inBox",value:function(t,e,i){return t.x>e.x&&t.y>e.y&&t.x<i.x&&t.y<i.y}},{key:"render",value:function(){return r.a.createElement("div",{id:"historybox"},r.a.createElement("canvas",{height:"100px",width:"100px",ref:this.canvRef,onPointerDown:this.pointerDownHandler.bind(this),onPointerUp:this.pointerUpHandler.bind(this),onPointerMove:this.pointerMoveHandler.bind(this)}))}}]),i}(a.Component),Y=Object(u.b)((function(t,e){return{traces:t.traces,initpenstate:t.initpenstate,uicolor:t.uicolor}}),(function(t){return{addTrace:function(e){t({type:"ADD_DRAWTRACE",trace:e})},addDisplaytrace:function(e,i){t({type:"ADD_DISPLAYTRACE",t:e,alpha:i})},clrDisplaytraces:function(){t({type:"CLR_DISPLAYTRACES"})},setPenstate:function(e){t({type:"SET_PENSTATE",update:e})}}}))(W);function _(){return(_=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(t[a]=i[a])}return t}).apply(this,arguments)}function X(t,e){if(null==t)return{};var i,a,r=function(t,e){if(null==t)return{};var i,a,r={},n=Object.keys(t);for(a=0;a<n.length;a++)i=n[a],e.indexOf(i)>=0||(r[i]=t[i]);return r}(t,e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);for(a=0;a<n.length;a++)i=n[a],e.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(r[i]=t[i])}return r}var V=function(t){var e=t.svgRef,i=t.title,a=X(t,["svgRef","title"]);return r.a.createElement("svg",_({viewBox:"0 0 400 100",xmlSpace:"preserve",style:{fillRule:"evenodd",clipRule:"evenodd",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1.5},ref:e},a),i?r.a.createElement("title",null,i):null,r.a.createElement("g",{transform:"matrix(6.12323e-17,1,-1,6.12323e-17,389.702,-390.097)"},r.a.createElement("path",{d:"M440.097,6.434L483.076,92.393L397.118,92.393L440.097,6.434Z",style:{fill:"white",stroke:"black",strokeWidth:"8.96px"}})),r.a.createElement("g",{transform:"matrix(1,0,0,1,3.99745,2.13163e-14)"},r.a.createElement("path",{d:"M91.823,7.021L91.823,92.979L34.224,92.979C22.364,92.979 12.735,83.35 12.735,71.49L12.735,28.51C12.735,16.65 22.364,7.021 34.224,7.021L91.823,7.021Z",style:{stroke:"black",strokeWidth:"8.96px"}})),r.a.createElement("g",{transform:"matrix(1,0,0,1,-37.9266,3.55271e-15)"},r.a.createElement("path",{d:"M171.247,7.021L238.773,50L171.247,92.979L148.794,92.979L148.794,7.021L171.247,7.021Z",style:{stroke:"black",strokeWidth:"8.96px"}})),r.a.createElement("g",{transform:"matrix(1,0,0,1,-37.9266,3.55271e-15)"},r.a.createElement("path",{d:"M230.228,50L297.755,7.021L320.208,7.021L320.208,92.979L297.755,92.979L230.228,50Z",style:{fill:"white",stroke:"black",strokeWidth:"8.96px"}})))},F=r.a.forwardRef((function(t,e){return r.a.createElement(V,_({svgRef:e},t))})),Z=(i.p,{fontFamily:void 0,fontSize:26,fontStyle:"italic",fontWeight:"bold"}),G=function(t){Object(c.a)(i,t);var e=Object(h.a)(i);function i(){return Object(o.a)(this,i),e.apply(this,arguments)}return Object(l.a)(i,[{key:"render",value:function(){return r.a.createElement("div",{id:"topbar"},r.a.createElement(F,{id:"logo"}),r.a.createElement("p",{id:"title",style:Z},"Timestroke Drawing Application"))}}]),i}(a.Component),q=function(t){Object(c.a)(i,t);var e=Object(h.a)(i);function i(){var t;Object(o.a)(this,i);for(var a=arguments.length,r=new Array(a),n=0;n<a;n++)r[n]=arguments[n];return(t=e.call.apply(e,[this].concat(r))).state={History:0},t}return Object(l.a)(i,[{key:"setHistory",value:function(t){this.setState({History:t,Historyoverlay:!1})}},{key:"componentDidMount",value:function(){this.props;document.addEventListener("keydown",this.keyDownHandler.bind(this))}},{key:"keyDownHandler",value:function(t){t.ctrlKey&&"z"===t.key?this.props.undo():t.ctrlKey&&"y"===t.key&&this.props.redo()}},{key:"render",value:function(){return r.a.createElement("div",{id:"appcontainer"},r.a.createElement(G,null),"2"===this.state.History&&r.a.createElement("div",{id:"button"},r.a.createElement(Y,null)),"1"===this.state.History&&r.a.createElement("div",{id:"historybar"},r.a.createElement(B,null)),r.a.createElement("div",{id:"topcontainer"},r.a.createElement(N,{setHistory:this.setHistory.bind(this)}),(0===this.state.History||"0"===this.state.History)&&r.a.createElement("button",{id:"buttonUndo",onClick:this.props.undo},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 18 18",version:"1.1",x:"0px",y:"0px"},r.a.createElement("title",null,"undo"),r.a.createElement("desc",null,"Created with Sketch."),r.a.createElement("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},r.a.createElement("g",{transform:"translate(-5.000000, -5.000000)",fill:"white"},r.a.createElement("path",{d:"M6.68026306,11 L10.5,15.3357608 L9.8637811,16 L5,10.5 L9.86412375,5 L10.4994224,5.61683991 L6.67592819,10 L16.5,10 C20.0898509,10 23,12.9101491 23,16.5 C23,20.0898509 20.0898509,23 16.5,23 L10,23 L10,22 L16.5,22 C19.5375661,22 22,19.5375661 22,16.5 C22,13.4624339 19.5375661,11 16.5,11 L6.68026306,11 Z"}))),r.a.createElement("text",{x:"0",y:"33",fill:"#000000","font-size":"5px","font-weight":"bold","font-family":"'Helvetica Neue', Helvetica, Arial-Unicode, Arial, Sans-serif"},"Created by xwoodhillx"),r.a.createElement("text",{x:"0",y:"38",fill:"#000000","font-size":"5px","font-weight":"bold","font-family":"'Helvetica Neue', Helvetica, Arial-Unicode, Arial, Sans-serif"},"from the Noun Project"))),(0===this.state.History||"0"===this.state.History)&&r.a.createElement("button",{id:"buttonRedo",onClick:this.props.redo},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",style:{transform:"scale(-1,1)"},viewBox:"0 0 18 18",version:"1.1",x:"0px",y:"0px"},r.a.createElement("title",null,"undo"),r.a.createElement("desc",null,"Created with Sketch."),r.a.createElement("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},r.a.createElement("g",{transform:"translate(-5.000000, -5.000000)",fill:"white"},r.a.createElement("path",{d:"M6.68026306,11 L10.5,15.3357608 L9.8637811,16 L5,10.5 L9.86412375,5 L10.4994224,5.61683991 L6.67592819,10 L16.5,10 C20.0898509,10 23,12.9101491 23,16.5 C23,20.0898509 20.0898509,23 16.5,23 L10,23 L10,22 L16.5,22 C19.5375661,22 22,19.5375661 22,16.5 C22,13.4624339 19.5375661,11 16.5,11 L6.68026306,11 Z"}))),r.a.createElement("text",{x:"0",y:"33",fill:"#000000","font-size":"5px","font-weight":"bold","font-family":"'Helvetica Neue', Helvetica, Arial-Unicode, Arial, Sans-serif"},"Created by xwoodhillx"),r.a.createElement("text",{x:"0",y:"38",fill:"#000000","font-size":"5px","font-weight":"bold","font-family":"'Helvetica Neue', Helvetica, Arial-Unicode, Arial, Sans-serif"},"from the Noun Project"))),r.a.createElement(E,null),r.a.createElement("div",{id:"drawing-canvas-container"},r.a.createElement(H,{history:this.state.History}))))}}]),i}(a.Component),K=Object(u.b)(null,(function(t){return{undo:function(){t({type:"UNDO"})},redo:function(){t({type:"REDO"})}}}))(q);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var J=i(12),$={traces:[],penstate:{color:"#000000",alpha:1,point:.1,linedash:!1,saturation:1,end:0,fill:0,shadow:0,line:0},initpenstate:{color:"#000000",alpha:1,point:.1,linedash:!1,saturation:1,end:0,fill:0,shadow:0,line:0},t:1,deltaT:0,displaytraces:[],uicolor:"white"};function Q(t,e){for(var i=0;i<t.length&&t[i].t<=e;i++);return t.slice(0,i)}function tt(t,e,i){for(var a=0;a<t.length&&!(t[a].t>i);a++)"ui"===t[a].type&&(e=Object(d.a)(Object(d.a)({},e),t[a].changes));return e}var et=function(){var t,e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"ADD_UITRACE":return 0===i.deltaT?(e=i.traces,r=i.t+1):(e=Q(i.traces,i.t+i.deltaT),r=Math.min(i.t,Math.max(i.t+i.deltaT,0))+1),t=[].concat(Object(f.a)(e),[{type:"ui",changes:a.changes,trace:a.trace,t:r}]),Object(d.a)(Object(d.a)({},i),{},{traces:t,t:r,deltaT:0});case"ADD_DRAWTRACE":return 0===i.deltaT?(e=i.traces,r=i.t+1):(e=Q(i.traces,i.t+i.deltaT),r=Math.min(i.t,Math.max(i.t+i.deltaT,0))+1),t=[].concat(Object(f.a)(e),[{type:"draw",changes:null,trace:a.trace,t:r}]),Object(d.a)(Object(d.a)({},i),{},{traces:t,t:r,deltaT:0});case"ADD_IMAGE":return 0===i.deltaT?(e=i.traces,r=i.t+1):(e=Q(i.traces,i.t+i.deltaT),r=Math.min(i.t,Math.max(i.t+i.deltaT,0))+1),t=[].concat(Object(f.a)(e),[{type:"image",imgData:a.imgData,t:r,height:a.height,width:a.width}]),Object(d.a)(Object(d.a)({},i),{},{traces:t,t:r,deltaT:0});case"ADD_IMAGETRACE":var r;return 0===i.deltaT?(e=i.traces,r=i.t+1):(e=Q(i.traces,i.t+i.deltaT),r=Math.min(i.t,Math.max(i.t+i.deltaT,0))+1),t=[].concat(Object(f.a)(e),[{type:"imgtrace",transform:a.transform,trace:a.trace,t:r}]),Object(d.a)(Object(d.a)({},i),{},{traces:t,t:r,deltaT:0});case"DEL_UITRACE":var n=tt(t=Object(f.a)(i.traces.filter((function(t){return t.t!==a.t}))),i.initpenstate,i.t+i.deltaT);return Object(d.a)(Object(d.a)({},i),{},{traces:t,penstate:n});case"SET_PENSTATE":return Object(d.a)(Object(d.a)({},i),{},{penstate:Object(d.a)(Object(d.a)({},i.penstate),a.update)});case"CHECK":return Object(d.a)(Object(d.a)({},i),{},{penstate:Object(d.a)(Object(d.a)({},i.penstate),{},Object(p.a)({},a.id,!i.penstate[a.id]))});case"SET_INIT":return Object(d.a)(Object(d.a)({},i),{},{penstate:i.initpenstate});case"ADD_DISPLAYTRACE":if(i.displaytraces.find((function(t){return t.t===a.t})))return Object(d.a)({},i);var s=[].concat(Object(f.a)(i.displaytraces),[{t:a.t,alpha:a.alpha}]);return Object(d.a)(Object(d.a)({},i),{},{displaytraces:s});case"CLR_DISPLAYTRACES":return Object(d.a)(Object(d.a)({},i),{},{displaytraces:[]});case"CLR_DISPLAYTRACE":return t=Object(f.a)(i.displaytraces.filter((function(t){return t.t!==a.t}))),Object(d.a)(Object(d.a)({},i),{},{displaytraces:t});case"SET_DISPLAYTRACES":return Object(d.a)(Object(d.a)({},i),{},{displaytraces:a.list});case"DELTA_T":return Object(d.a)(Object(d.a)({},i),{},{deltaT:a.deltaT});case"UNDO":n=tt(i.traces,i.initpenstate,i.t+i.deltaT-1);return Object(d.a)(Object(d.a)({},i),{},{deltaT:i.deltaT-1,penstate:n});case"REDO":n=tt(i.traces,i.initpenstate,i.t+i.deltaT-1);return Object(d.a)(Object(d.a)({},i),{},{deltaT:i.deltaT+1,penstate:n})}return i},it=Object(J.b)(et);s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(u.a,{store:it},r.a.createElement(K,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[19,1,2]]]);
//# sourceMappingURL=main.eb6dfdcf.chunk.js.map